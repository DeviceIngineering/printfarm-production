# üìã –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ SimplePrint

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 22 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** v4.2.1
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å SimplePrint API —Å –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å –≤–∫–ª–∞–¥–∫–æ–π "–¢–æ—á–∫–∞"

---

## üéØ –û–±—â–∞—è —Ü–µ–ª—å

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å SimplePrint API:
- ‚úÖ –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SimplePrint
- ‚úÖ API endpoints –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –≤–∫–ª–∞–¥–∫–æ–π "–¢–æ—á–∫–∞"
- ‚úÖ –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ git –∫–æ–º–º–∏—Ç—ã

---

## üìä –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### **–≠–¢–ê–ü 1: –ê–Ω–∞–ª–∏–∑ –∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (1-2 —á–∞—Å–∞)

#### –®–∞–≥ 1.1: –ò–∑—É—á–µ–Ω–∏–µ SimplePrint API
**–ó–∞–¥–∞—á–∏:**
- [ ] –ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é SimplePrint API
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ endpoints
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∑–∞–∫–∞–∑—ã, —Å—Ç–∞—Ç—É—Å—ã, —Ç–æ–≤–∞—Ä—ã)
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ª–∏–º–∏—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è API
- [ ] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å API credentials –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–¢–µ—Å—Ç—ã:**
- –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SimplePrint API
- –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
logger.info("SimplePrint API connection test started")
logger.debug(f"API endpoint: {endpoint}")
logger.info("SimplePrint API connection successful")
```

**Git commit:**
```bash
git commit -m "üìù Docs: Add SimplePrint API research and credentials setup

- Added SimplePrint API documentation
- Configured environment variables
- Added basic connection tests
"
```

---

#### –®–∞–≥ 1.2: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è SimplePrint
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å API endpoints –¥–ª—è frontend
- [ ] –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å "–¢–æ—á–∫–∞"
- [ ] –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç SIMPLEPRINT_ARCHITECTURE.md

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
```
backend/apps/simpleprint/
‚îú‚îÄ‚îÄ models.py           # SimplePrintOrder, SimplePrintProduct
‚îú‚îÄ‚îÄ serializers.py      # API serializers
‚îú‚îÄ‚îÄ views.py            # REST API endpoints
‚îú‚îÄ‚îÄ services.py         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ client.py           # SimplePrint API client
‚îú‚îÄ‚îÄ tasks.py            # Celery tasks –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ tests/
    ‚îú‚îÄ‚îÄ test_models.py
    ‚îú‚îÄ‚îÄ test_views.py
    ‚îú‚îÄ‚îÄ test_services.py
    ‚îî‚îÄ‚îÄ test_client.py

frontend/src/pages/SimplePrintPage/
‚îú‚îÄ‚îÄ SimplePrintPage.tsx
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ OrdersTable.tsx
‚îÇ   ‚îú‚îÄ‚îÄ OrderDetails.tsx
‚îÇ   ‚îî‚îÄ‚îÄ SyncButton.tsx
‚îî‚îÄ‚îÄ __tests__/
```

**Git commit:**
```bash
git commit -m "üìê Design: SimplePrint integration architecture

- Created architecture diagram
- Designed data models
- Planned API endpoints
- Added SIMPLEPRINT_ARCHITECTURE.md
"
```

---

### **–≠–¢–ê–ü 2: Backend - SimplePrint API Client** (2-3 —á–∞—Å–∞)

#### –®–∞–≥ 2.1: –°–æ–∑–¥–∞–Ω–∏–µ Django app
**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å Django app `simpleprint`
- [ ] –î–æ–±–∞–≤–∏—Ç—å app –≤ INSTALLED_APPS
- [ ] –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å URL routing

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
cd backend
python manage.py startapp simpleprint
mkdir -p apps/simpleprint/tests
```

**–§–∞–π–ª:** `backend/apps/simpleprint/__init__.py`
```python
"""
SimplePrint Integration Module

–ú–æ–¥—É–ª—å –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å SimplePrint API.
–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö,
—Å—Ç–∞—Ç—É—Å–∞—Ö –ø–µ—á–∞—Ç–∏ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–æ–π PrintFarm.
"""

default_app_config = 'apps.simpleprint.apps.SimpleprintConfig'
```

**–¢–µ—Å—Ç—ã:**
```python
# apps/simpleprint/tests/test_app_config.py
def test_app_installed():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ app —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"""
    assert 'apps.simpleprint' in settings.INSTALLED_APPS
```

**–õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
import logging

logger = logging.getLogger('simpleprint')
logger.info("SimplePrint app initialized")
```

**Git commit:**
```bash
git commit -m "üé¨ Init: Create SimplePrint Django app

- Created simpleprint app structure
- Added to INSTALLED_APPS
- Added basic tests
- Added logging configuration
"
```

---

#### –®–∞–≥ 2.2: SimplePrint API Client
**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç –¥–ª—è SimplePrint API
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã: get_orders(), get_order_details(), get_statuses()
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ retry –ª–æ–≥–∏–∫—É
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting

**–§–∞–π–ª:** `backend/apps/simpleprint/client.py`
```python
import logging
import requests
from typing import List, Dict, Optional
from django.conf import settings
from requests.adapters import HTTPAdapter
from urllib3.util.retry import Retry

logger = logging.getLogger('simpleprint.client')


class SimplePrintAPIError(Exception):
    """Base exception for SimplePrint API errors"""
    pass


class SimplePrintClient:
    """
    –ö–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å SimplePrint API

    –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
        client = SimplePrintClient()
        orders = client.get_orders()
        order = client.get_order_details(order_id)
    """

    def __init__(self):
        self.base_url = settings.SIMPLEPRINT_API_URL
        self.api_key = settings.SIMPLEPRINT_API_KEY
        self.company_id = settings.SIMPLEPRINT_COMPANY_ID
        self.user_id = settings.SIMPLEPRINT_USER_ID
        self.timeout = 30

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ retry –ª–æ–≥–∏–∫–∏
        retry_strategy = Retry(
            total=3,
            backoff_factor=1,
            status_forcelist=[429, 500, 502, 503, 504],
        )
        adapter = HTTPAdapter(max_retries=retry_strategy)
        self.session = requests.Session()
        self.session.mount("https://", adapter)
        self.session.mount("http://", adapter)

        logger.info(f"SimplePrint client initialized for company {self.company_id}")

    def _get_headers(self) -> Dict[str, str]:
        """–ü–æ–ª—É—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è API –∑–∞–ø—Ä–æ—Å–∞"""
        return {
            'Authorization': f'Bearer {self.api_key}',
            'Content-Type': 'application/json',
            'Accept': 'application/json',
        }

    def _make_request(self, method: str, endpoint: str, **kwargs) -> Dict:
        """
        –í—ã–ø–æ–ª–Ω–∏—Ç—å API –∑–∞–ø—Ä–æ—Å —Å –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

        Args:
            method: HTTP –º–µ—Ç–æ–¥ (GET, POST, etc.)
            endpoint: API endpoint
            **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è requests

        Returns:
            Dict: –û—Ç–≤–µ—Ç –æ—Ç API

        Raises:
            SimplePrintAPIError: –ü—Ä–∏ –æ—à–∏–±–∫–µ API –∑–∞–ø—Ä–æ—Å–∞
        """
        url = f"{self.base_url}/{endpoint}"

        logger.debug(f"Making {method} request to {url}")
        logger.debug(f"Request params: {kwargs.get('params', {})}")

        try:
            response = self.session.request(
                method=method,
                url=url,
                headers=self._get_headers(),
                timeout=self.timeout,
                **kwargs
            )
            response.raise_for_status()

            data = response.json()
            logger.info(f"API request successful: {method} {endpoint}")
            logger.debug(f"Response data: {data}")

            return data

        except requests.exceptions.HTTPError as e:
            logger.error(f"HTTP error: {e}")
            logger.error(f"Response: {e.response.text}")
            raise SimplePrintAPIError(f"HTTP {e.response.status_code}: {e.response.text}")
        except requests.exceptions.Timeout as e:
            logger.error(f"Timeout error: {e}")
            raise SimplePrintAPIError("API request timeout")
        except requests.exceptions.RequestException as e:
            logger.error(f"Request error: {e}")
            raise SimplePrintAPIError(f"Request failed: {str(e)}")

    def get_orders(self, filters: Optional[Dict] = None) -> List[Dict]:
        """
        –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤

        Args:
            filters: –§–∏–ª—å—Ç—Ä—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ (status, date_from, date_to, etc.)

        Returns:
            List[Dict]: –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
        """
        logger.info("Fetching orders from SimplePrint")

        params = {
            'company_id': self.company_id,
            'user_id': self.user_id,
        }

        if filters:
            params.update(filters)
            logger.debug(f"Applying filters: {filters}")

        data = self._make_request('GET', 'orders', params=params)

        orders = data.get('orders', [])
        logger.info(f"Fetched {len(orders)} orders")

        return orders

    def get_order_details(self, order_id: str) -> Dict:
        """
        –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞

        Args:
            order_id: ID –∑–∞–∫–∞–∑–∞

        Returns:
            Dict: –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
        """
        logger.info(f"Fetching order details: {order_id}")

        data = self._make_request('GET', f'orders/{order_id}')

        logger.info(f"Order details fetched: {order_id}")
        return data

    def get_statuses(self) -> List[Dict]:
        """
        –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤

        Returns:
            List[Dict]: –°–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç—É—Å–æ–≤
        """
        logger.info("Fetching order statuses")

        data = self._make_request('GET', 'statuses')

        statuses = data.get('statuses', [])
        logger.info(f"Fetched {len(statuses)} statuses")

        return statuses

    def test_connection(self) -> bool:
        """
        –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API

        Returns:
            bool: True –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ
        """
        logger.info("Testing SimplePrint API connection")

        try:
            self.get_statuses()
            logger.info("Connection test successful")
            return True
        except SimplePrintAPIError as e:
            logger.error(f"Connection test failed: {e}")
            return False
```

**–¢–µ—Å—Ç—ã:** `backend/apps/simpleprint/tests/test_client.py`
```python
import pytest
from unittest.mock import Mock, patch
from apps.simpleprint.client import SimplePrintClient, SimplePrintAPIError


class TestSimplePrintClient:
    """–¢–µ—Å—Ç—ã –¥–ª—è SimplePrint API –∫–ª–∏–µ–Ω—Ç–∞"""

    @pytest.fixture
    def client(self):
        return SimplePrintClient()

    @patch('apps.simpleprint.client.requests.Session.request')
    def test_get_orders_success(self, mock_request, client):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤"""
        mock_response = Mock()
        mock_response.json.return_value = {
            'orders': [
                {'id': '1', 'status': 'pending'},
                {'id': '2', 'status': 'processing'}
            ]
        }
        mock_response.raise_for_status = Mock()
        mock_request.return_value = mock_response

        orders = client.get_orders()

        assert len(orders) == 2
        assert orders[0]['id'] == '1'
        mock_request.assert_called_once()

    @patch('apps.simpleprint.client.requests.Session.request')
    def test_get_orders_with_filters(self, mock_request, client):
        """–¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏"""
        mock_response = Mock()
        mock_response.json.return_value = {'orders': []}
        mock_response.raise_for_status = Mock()
        mock_request.return_value = mock_response

        filters = {'status': 'completed', 'date_from': '2025-01-01'}
        client.get_orders(filters=filters)

        call_kwargs = mock_request.call_args[1]
        assert 'status' in call_kwargs['params']
        assert call_kwargs['params']['status'] == 'completed'

    @patch('apps.simpleprint.client.requests.Session.request')
    def test_api_error_handling(self, mock_request, client):
        """–¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ API"""
        mock_response = Mock()
        mock_response.raise_for_status.side_effect = requests.exceptions.HTTPError()
        mock_response.status_code = 401
        mock_response.text = "Unauthorized"
        mock_request.return_value = mock_response

        with pytest.raises(SimplePrintAPIError):
            client.get_orders()

    @patch('apps.simpleprint.client.requests.Session.request')
    def test_connection_test(self, mock_request, client):
        """–¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"""
        mock_response = Mock()
        mock_response.json.return_value = {'statuses': []}
        mock_response.raise_for_status = Mock()
        mock_request.return_value = mock_response

        result = client.test_connection()

        assert result is True
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:** `backend/config/settings/base.py`
```python
# SimplePrint API Configuration
SIMPLEPRINT_API_URL = env.str('SIMPLEPRINT_API_URL', default='https://api.simpleprint.ru/v1')
SIMPLEPRINT_API_KEY = env.str('SIMPLEPRINT_API_KEY', default='')
SIMPLEPRINT_COMPANY_ID = env.int('SIMPLEPRINT_COMPANY_ID', default=27286)
SIMPLEPRINT_USER_ID = env.int('SIMPLEPRINT_USER_ID', default=31471)
SIMPLEPRINT_RATE_LIMIT = env.int('SIMPLEPRINT_RATE_LIMIT', default=10)  # requests per second

# Logging
LOGGING['loggers']['simpleprint'] = {
    'handlers': ['console', 'file'],
    'level': 'DEBUG',
    'propagate': False,
}
```

**Git commit:**
```bash
git commit -m "‚ú® Feature: Add SimplePrint API client

- Created SimplePrintClient with retry logic
- Implemented get_orders, get_order_details, get_statuses
- Added comprehensive error handling
- Added logging for all operations
- Added unit tests (100% coverage)
- Added settings configuration
"
```

---

#### –®–∞–≥ 2.3: –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å SimplePrintOrder
- [ ] –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å SimplePrintSync (–∏—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑—å —Å Product –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `backend/apps/simpleprint/models.py`
```python
import logging
from django.db import models
from django.utils import timezone

logger = logging.getLogger('simpleprint.models')


class SimplePrintOrder(models.Model):
    """
    –ó–∞–∫–∞–∑ –∏–∑ SimplePrint

    –•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–∫–∞–∑–∞—Ö –ø–µ—á–∞—Ç–∏ –∏–∑ SimplePrint API
    """

    STATUS_CHOICES = [
        ('pending', '–û–∂–∏–¥–∞–µ—Ç'),
        ('processing', '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ'),
        ('printing', '–ü–µ—á–∞—Ç–∞–µ—Ç—Å—è'),
        ('completed', '–ó–∞–≤–µ—Ä—à–µ–Ω'),
        ('cancelled', '–û—Ç–º–µ–Ω–µ–Ω'),
    ]

    # SimplePrint –¥–∞–Ω–Ω—ã–µ
    simpleprint_id = models.CharField(max_length=100, unique=True, db_index=True)
    order_number = models.CharField(max_length=255)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='pending')

    # –¢–æ–≤–∞—Ä
    product = models.ForeignKey(
        'products.Product',
        on_delete=models.SET_NULL,
        null=True,
        blank=True,
        related_name='simpleprint_orders'
    )
    article = models.CharField(max_length=255, db_index=True)
    product_name = models.CharField(max_length=500)

    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –¥–∞—Ç—ã
    quantity = models.DecimalField(max_digits=10, decimal_places=2)
    order_date = models.DateTimeField()
    completion_date = models.DateTimeField(null=True, blank=True)

    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    customer_name = models.CharField(max_length=255, blank=True)
    notes = models.TextField(blank=True)
    raw_data = models.JSONField(default=dict, help_text="–ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ SimplePrint API")

    # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    last_synced_at = models.DateTimeField(null=True, blank=True)

    class Meta:
        ordering = ['-order_date', 'simpleprint_id']
        indexes = [
            models.Index(fields=['status', 'order_date']),
            models.Index(fields=['article', 'status']),
        ]
        verbose_name = 'SimplePrint –ó–∞–∫–∞–∑'
        verbose_name_plural = 'SimplePrint –ó–∞–∫–∞–∑—ã'

    def __str__(self):
        return f"Order {self.order_number} - {self.product_name}"

    def save(self, *args, **kwargs):
        """–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º save –¥–ª—è –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è"""
        is_new = self.pk is None
        super().save(*args, **kwargs)

        if is_new:
            logger.info(f"Created new SimplePrint order: {self.simpleprint_id}")
        else:
            logger.debug(f"Updated SimplePrint order: {self.simpleprint_id}")

    def mark_as_synced(self):
        """–û—Ç–º–µ—Ç–∏—Ç—å –∑–∞–∫–∞–∑ –∫–∞–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π"""
        self.last_synced_at = timezone.now()
        self.save()
        logger.info(f"Order {self.simpleprint_id} marked as synced")


class SimplePrintSync(models.Model):
    """
    –ò—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π —Å SimplePrint
    """

    STATUS_CHOICES = [
        ('pending', '–í –ø—Ä–æ—Ü–µ—Å—Å–µ'),
        ('success', '–£—Å–ø–µ—à–Ω–æ'),
        ('failed', '–û—à–∏–±–∫–∞'),
        ('partial', '–ß–∞—Å—Ç–∏—á–Ω–æ'),
    ]

    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='pending')

    started_at = models.DateTimeField(auto_now_add=True)
    finished_at = models.DateTimeField(null=True, blank=True)

    total_orders = models.IntegerField(default=0)
    synced_orders = models.IntegerField(default=0)
    failed_orders = models.IntegerField(default=0)

    filters = models.JSONField(default=dict, help_text="–§–∏–ª—å—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏")
    error_details = models.TextField(blank=True)

    class Meta:
        ordering = ['-started_at']
        verbose_name = 'SimplePrint –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è'
        verbose_name_plural = 'SimplePrint –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏'

    def __str__(self):
        return f"Sync {self.started_at.strftime('%Y-%m-%d %H:%M')} - {self.status}"

    def complete(self, status='success', error_details=''):
        """–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é"""
        self.status = status
        self.finished_at = timezone.now()
        self.error_details = error_details
        self.save()

        logger.info(f"Sync completed: {self.status}, {self.synced_orders}/{self.total_orders}")
```

**–¢–µ—Å—Ç—ã:** `backend/apps/simpleprint/tests/test_models.py`
```python
import pytest
from django.utils import timezone
from apps.simpleprint.models import SimplePrintOrder, SimplePrintSync
from apps.products.models import Product


@pytest.mark.django_db
class TestSimplePrintOrder:
    """–¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–∏ SimplePrintOrder"""

    def test_create_order(self):
        """–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞"""
        order = SimplePrintOrder.objects.create(
            simpleprint_id='SP-12345',
            order_number='ORD-001',
            article='TEST-001',
            product_name='Test Product',
            quantity=10,
            order_date=timezone.now()
        )

        assert order.pk is not None
        assert order.status == 'pending'
        assert str(order) == 'Order ORD-001 - Test Product'

    def test_mark_as_synced(self):
        """–¢–µ—Å—Ç –æ—Ç–º–µ—Ç–∫–∏ –æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏"""
        order = SimplePrintOrder.objects.create(
            simpleprint_id='SP-12346',
            order_number='ORD-002',
            article='TEST-002',
            product_name='Test Product 2',
            quantity=5,
            order_date=timezone.now()
        )

        assert order.last_synced_at is None

        order.mark_as_synced()

        assert order.last_synced_at is not None


@pytest.mark.django_db
class TestSimplePrintSync:
    """–¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–∏ SimplePrintSync"""

    def test_create_sync(self):
        """–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏"""
        sync = SimplePrintSync.objects.create(
            total_orders=100
        )

        assert sync.status == 'pending'
        assert sync.synced_orders == 0

    def test_complete_sync(self):
        """–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏"""
        sync = SimplePrintSync.objects.create(
            total_orders=100,
            synced_orders=95
        )

        sync.complete(status='success')

        assert sync.status == 'success'
        assert sync.finished_at is not None
```

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
python manage.py makemigrations simpleprint
python manage.py migrate
```

**Git commit:**
```bash
git commit -m "üíæ Models: Add SimplePrint data models

- Created SimplePrintOrder model
- Created SimplePrintSync model
- Added relationship with Product
- Added comprehensive tests
- Added migrations
"
```

---

### **–≠–¢–ê–ü 3: Backend - API Endpoints** (2-3 —á–∞—Å–∞)

#### –®–∞–≥ 3.1: –°–µ—Ä–≤–∏—Å—ã –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å SimplePrintService
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å sync_orders()
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å match_with_products()
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `backend/apps/simpleprint/services.py`
```python
import logging
from typing import List, Dict, Optional
from decimal import Decimal
from django.db import transaction
from django.utils import timezone
from django.core.cache import cache

from .client import SimplePrintClient, SimplePrintAPIError
from .models import SimplePrintOrder, SimplePrintSync
from apps.products.models import Product

logger = logging.getLogger('simpleprint.services')


class SimplePrintService:
    """
    –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å SimplePrint –¥–∞–Ω–Ω—ã–º–∏
    """

    def __init__(self):
        self.client = SimplePrintClient()
        logger.debug("SimplePrintService initialized")

    def sync_orders(self, filters: Optional[Dict] = None) -> SimplePrintSync:
        """
        –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ –∏–∑ SimplePrint

        Args:
            filters: –§–∏–ª—å—Ç—Ä—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞

        Returns:
            SimplePrintSync: –ó–∞–ø–∏—Å—å –æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        """
        logger.info("Starting SimplePrint orders synchronization")

        # –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        sync_log = SimplePrintSync.objects.create(filters=filters or {})

        try:
            # –ü–æ–ª—É—á–∞–µ–º –∑–∞–∫–∞–∑—ã –∏–∑ API
            orders_data = self.client.get_orders(filters=filters)
            sync_log.total_orders = len(orders_data)
            sync_log.save()

            logger.info(f"Fetched {len(orders_data)} orders from SimplePrint")

            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π –∑–∞–∫–∞–∑
            synced = 0
            failed = 0

            for order_data in orders_data:
                try:
                    self._process_order(order_data)
                    synced += 1

                    # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 10 –∑–∞–∫–∞–∑–æ–≤
                    if synced % 10 == 0:
                        sync_log.synced_orders = synced
                        sync_log.save()
                        logger.debug(f"Sync progress: {synced}/{len(orders_data)}")

                except Exception as e:
                    logger.error(f"Failed to process order {order_data.get('id')}: {e}")
                    failed += 1

            # –ó–∞–≤–µ—Ä—à–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
            sync_log.synced_orders = synced
            sync_log.failed_orders = failed

            if failed == 0:
                sync_log.complete(status='success')
            elif synced > 0:
                sync_log.complete(status='partial', error_details=f'{failed} orders failed')
            else:
                sync_log.complete(status='failed', error_details='All orders failed')

            logger.info(f"Sync completed: {synced} synced, {failed} failed")

            return sync_log

        except SimplePrintAPIError as e:
            logger.error(f"SimplePrint API error: {e}")
            sync_log.complete(status='failed', error_details=str(e))
            raise
        except Exception as e:
            logger.error(f"Unexpected error during sync: {e}")
            sync_log.complete(status='failed', error_details=str(e))
            raise

    @transaction.atomic
    def _process_order(self, order_data: Dict) -> SimplePrintOrder:
        """
        –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–∏–Ω –∑–∞–∫–∞–∑

        Args:
            order_data: –î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ –∏–∑ API

        Returns:
            SimplePrintOrder: –°–æ–∑–¥–∞–Ω–Ω—ã–π/–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑
        """
        simpleprint_id = order_data['id']

        # –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∑–∞–∫–∞–∑
        order, created = SimplePrintOrder.objects.update_or_create(
            simpleprint_id=simpleprint_id,
            defaults={
                'order_number': order_data.get('order_number', ''),
                'status': order_data.get('status', 'pending'),
                'article': order_data.get('article', ''),
                'product_name': order_data.get('product_name', ''),
                'quantity': Decimal(str(order_data.get('quantity', 0))),
                'order_date': order_data.get('order_date'),
                'completion_date': order_data.get('completion_date'),
                'customer_name': order_data.get('customer', {}).get('name', ''),
                'notes': order_data.get('notes', ''),
                'raw_data': order_data,
                'last_synced_at': timezone.now(),
            }
        )

        if created:
            logger.info(f"Created new order: {simpleprint_id}")
        else:
            logger.debug(f"Updated existing order: {simpleprint_id}")

        # –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–æ–≤–∞—Ä
        self._match_order_with_product(order)

        return order

    def _match_order_with_product(self, order: SimplePrintOrder):
        """
        –°–≤—è–∑–∞—Ç—å –∑–∞–∫–∞–∑ —Å —Ç–æ–≤–∞—Ä–æ–º –∏–∑ Product

        Args:
            order: SimplePrintOrder
        """
        if order.product:
            return  # –£–∂–µ —Å–≤—è–∑–∞–Ω

        try:
            # –ò—â–µ–º —Ç–æ–≤–∞—Ä –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É
            product = Product.objects.filter(article=order.article).first()

            if product:
                order.product = product
                order.save()
                logger.info(f"Matched order {order.simpleprint_id} with product {product.article}")
            else:
                logger.warning(f"No product found for article: {order.article}")

        except Exception as e:
            logger.error(f"Error matching order with product: {e}")

    def get_orders_stats(self) -> Dict:
        """
        –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∑–∞–∫–∞–∑–∞–º

        Returns:
            Dict: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        """
        cache_key = 'simpleprint_orders_stats'
        stats = cache.get(cache_key)

        if stats:
            logger.debug("Returning cached stats")
            return stats

        stats = {
            'total': SimplePrintOrder.objects.count(),
            'by_status': {},
            'unmatched_count': SimplePrintOrder.objects.filter(product__isnull=True).count(),
        }

        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
        for status, _ in SimplePrintOrder.STATUS_CHOICES:
            count = SimplePrintOrder.objects.filter(status=status).count()
            stats['by_status'][status] = count

        # –ö–µ—à–∏—Ä—É–µ–º –Ω–∞ 5 –º–∏–Ω—É—Ç
        cache.set(cache_key, stats, 300)

        logger.info(f"Generated stats: {stats}")
        return stats

    def match_all_orders_with_products(self) -> int:
        """
        –°–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ –Ω–µ—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã —Å —Ç–æ–≤–∞—Ä–∞–º–∏

        Returns:
            int: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
        """
        logger.info("Starting batch matching of orders with products")

        unmatched_orders = SimplePrintOrder.objects.filter(product__isnull=True)
        matched_count = 0

        for order in unmatched_orders:
            self._match_order_with_product(order)
            if order.product:
                matched_count += 1

        logger.info(f"Matched {matched_count} orders with products")
        return matched_count
```

**–¢–µ—Å—Ç—ã:** `backend/apps/simpleprint/tests/test_services.py`
```python
import pytest
from unittest.mock import Mock, patch
from apps.simpleprint.services import SimplePrintService
from apps.simpleprint.models import SimplePrintOrder, SimplePrintSync
from apps.products.models import Product


@pytest.mark.django_db
class TestSimplePrintService:
    """–¢–µ—Å—Ç—ã SimplePrintService"""

    @pytest.fixture
    def service(self):
        return SimplePrintService()

    @pytest.fixture
    def mock_orders_data(self):
        return [
            {
                'id': 'SP-001',
                'order_number': 'ORD-001',
                'status': 'pending',
                'article': 'TEST-001',
                'product_name': 'Test Product 1',
                'quantity': 10,
                'order_date': '2025-10-01T10:00:00Z',
            },
            {
                'id': 'SP-002',
                'order_number': 'ORD-002',
                'status': 'processing',
                'article': 'TEST-002',
                'product_name': 'Test Product 2',
                'quantity': 5,
                'order_date': '2025-10-02T11:00:00Z',
            }
        ]

    @patch('apps.simpleprint.services.SimplePrintClient.get_orders')
    def test_sync_orders_success(self, mock_get_orders, service, mock_orders_data):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏"""
        mock_get_orders.return_value = mock_orders_data

        sync_log = service.sync_orders()

        assert sync_log.status == 'success'
        assert sync_log.total_orders == 2
        assert sync_log.synced_orders == 2
        assert sync_log.failed_orders == 0

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∑–∞–∫–∞–∑—ã —Å–æ–∑–¥–∞–Ω—ã
        assert SimplePrintOrder.objects.count() == 2

    @pytest.mark.django_db
    def test_match_order_with_product(self, service):
        """–¢–µ—Å—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ —Å —Ç–æ–≤–∞—Ä–æ–º"""
        # –°–æ–∑–¥–∞–µ–º —Ç–æ–≤–∞—Ä
        product = Product.objects.create(
            moysklad_id='MS-001',
            article='TEST-001',
            name='Test Product'
        )

        # –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
        order = SimplePrintOrder.objects.create(
            simpleprint_id='SP-001',
            order_number='ORD-001',
            article='TEST-001',
            product_name='Test Product',
            quantity=10
        )

        # –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ–º
        service._match_order_with_product(order)

        order.refresh_from_db()
        assert order.product == product

    def test_get_orders_stats(self, service):
        """–¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
        # –°–æ–∑–¥–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤
        SimplePrintOrder.objects.create(
            simpleprint_id='SP-001',
            order_number='ORD-001',
            status='pending',
            article='TEST-001',
            quantity=10
        )
        SimplePrintOrder.objects.create(
            simpleprint_id='SP-002',
            order_number='ORD-002',
            status='completed',
            article='TEST-002',
            quantity=5
        )

        stats = service.get_orders_stats()

        assert stats['total'] == 2
        assert stats['by_status']['pending'] == 1
        assert stats['by_status']['completed'] == 1
```

**Git commit:**
```bash
git commit -m "‚öôÔ∏è Services: Add SimplePrint business logic

- Created SimplePrintService
- Implemented sync_orders with progress tracking
- Implemented product matching logic
- Added caching for statistics
- Added comprehensive tests
- Added detailed logging
"
```

---

*–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏...*

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ø–ª–∞–Ω–∞. –ü–ª–∞–Ω –≤–∫–ª—é—á–∞–µ—Ç –µ—â–µ 4 —ç—Ç–∞–ø–∞:
- –≠—Ç–∞–ø 3.2-3.3: REST API endpoints
- –≠—Ç–∞–ø 4: Frontend - –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- –≠—Ç–∞–ø 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–∫–ª–∞–¥–∫–æ–π "–¢–æ—á–∫–∞"
- –≠—Ç–∞–ø 6: –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –≤–∫–ª—é—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ–¥, —Ç–µ—Å—Ç—ã –∏ git –∫–æ–º–º–∏—Ç—ã.

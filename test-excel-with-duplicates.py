#!/usr/bin/env python3
"""
Скрипт для создания тестового Excel файла с дубликатами артикулов
для проверки функции дедупликации в системе Точка
"""

import pandas as pd
import os

def create_test_excel():
    # Тестовые данные с дубликатами
    test_data = [
        {"Артикул товара": "ABC-001", "Заказов, шт.": 10},
        {"Артикул товара": "XYZ-002", "Заказов, шт.": 5},
        {"Артикул товара": "DEF-003", "Заказов, шт.": 8},
        {"Артикул товара": "ABC-001", "Заказов, шт.": 15},  # Дубликат ABC-001
        {"Артикул товара": "GHI-004", "Заказов, шт.": 12},
        {"Артикул товара": "XYZ-002", "Заказов, шт.": 3},   # Дубликат XYZ-002
        {"Артикул товара": "JKL-005", "Заказов, шт.": 7},
        {"Артикул товара": "ABC-001", "Заказов, шт.": 5},   # Еще один дубликат ABC-001
        {"Артикул товара": "MNO-006", "Заказов, шт.": 20},
        {"Артикул товара": "DEF-003", "Заказов, шт.": 4},   # Дубликат DEF-003
    ]
    
    # Создаем DataFrame
    df = pd.DataFrame(test_data)
    
    # Сохраняем в Excel
    output_file = "test-duplicates.xlsx"
    df.to_excel(output_file, index=False)
    
    print(f"✅ Создан тестовый файл: {output_file}")
    print("\n📊 Ожидаемые результаты после дедупликации:")
    print("ABC-001: 10 + 15 + 5 = 30 шт (строки 1, 4, 8)")
    print("XYZ-002: 5 + 3 = 8 шт (строки 2, 6)")
    print("DEF-003: 8 + 4 = 12 шт (строки 3, 10)")
    print("GHI-004: 12 шт (уникальный)")
    print("JKL-005: 7 шт (уникальный)")
    print("MNO-006: 20 шт (уникальный)")
    print(f"\nВсего исходных записей: {len(test_data)}")
    print("Уникальных артикулов: 6")
    print("Дубликатов объединено: 4")
    
    # Показываем исходную таблицу
    print("\n📋 Исходные данные:")
    for i, row in enumerate(test_data, 1):
        print(f"Строка {i}: {row['Артикул товара']} -> {row['Заказов, шт.']} шт")

if __name__ == "__main__":
    create_test_excel()